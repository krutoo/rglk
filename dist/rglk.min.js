!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.rglk=e():t.rglk=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e,n){i(this,t),this._x=isNaN(e)?0:e,this._y=isNaN(e)?0:n}return o(t,[{key:"distance",value:function(t){return Math.sqrt(Math.pow(t.x-this.x,2)+Math.pow(t.y-this.y,2))}},{key:"x",get:function(){return this._x},set:function(t){isNaN(t)?console.warn("Point.x: value "+t+" is NaN"):this._x=t}},{key:"y",get:function(){return this._y},set:function(t){isNaN(t)?console.warn("Point.y: value "+t+" is NaN"):this._y=t}}]),t}();e.default=r},,function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){i(this,t),this._seed=isNaN(e)?12345:e}return o(t,[{key:"getRandom",value:function(t,e){return e=isNaN(e)?1:e,t=isNaN(t)?0:t,this._seed=(9301*this._seed+49297)%233280,t+this._seed/233280*(e-t)}},{key:"seed",get:function(){return this._seed},set:function(t){isNaN(t)||(this._seed=t)}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(0),u=i(s),a=n(7),f=i(a),c=n(2),h=i(c),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t),this._options={seed:isNaN(e.seed)?0:e.seed,roomAmount:isNaN(e.roomAmount)?5:e.roomAmount,roomMinSize:isNaN(e.roomMinSize)?3:e.roomMinSize,roomMaxSize:isNaN(e.roomMaxSize)?5:e.roomMaxSize,corridorMinLength:isNaN(e.corridorMinLength)?1:e.corridorMinLength,corridorMaxLength:isNaN(e.corridorMaxLength)?3:e.corridorMaxLength},this._tiles=[],this._rooms=[],this._corridors=[],this._prng=new h.default(this._options.seed)}return r(t,[{key:"updateOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=isNaN(t.seed)?this._options.seed:t.seed,n=isNaN(t.roomAmount)?this._options.roomAmount:t.roomAmount,i=isNaN(t.roomMinSize)?this._options.roomMinSize:t.roomMinSize,o=isNaN(t.roomMaxSize)?this._options.roomMaxSize:t.roomMaxSize,r=isNaN(t.corridorMinLength)?this._options.corridorMinLength:t.corridorMinLength,s=isNaN(t.corridorMaxLength)?this._options.corridorMaxLength:t.corridorMaxLength;this._prng=new h.default(e),this._options={seed:e,roomAmount:n,roomMinSize:i,roomMaxSize:o,corridorMinLength:r,corridorMaxLength:s}}},{key:"forEachTile",value:function(t){if(this._tiles.length&&t instanceof Function)for(var e=0;e<this._tiles.length;e++)for(var n=0;n<this._tiles[e].length;n++)t(n,e,this._tiles[e][n])}},{key:"isWall",value:function(t,e){if(void 0!==this._tiles[e]&&void 0!==this._tiles[e][t])return!this._tiles[e][t]}},{key:"generate",value:function(){this._correctOptions(),this._generateBuilds(),this._optimizeBuilds(),this._createMap()}},{key:"_correctOptions",value:function(){this._options.roomAmount<1&&(this._options.roomAmount=1),this._options.roomMinSize<1&&(this._options.roomMinSize=1),this._options.roomMaxSize<1&&(this._options.roomMaxSize=1),this._options.corridorMinLength<1&&(this._options.corridorMinLength=1),this._options.corridorMaxLength<1&&(this._options.corridorMaxLength=1)}},{key:"_generateBuilds",value:function(){var t=this,e=function(e,n){return Math.round(t._prng.getRandom(n,e))},n=this._options.roomAmount,i=this._options.roomMinSize,o=this._options.roomMaxSize,r=this._options.corridorMinLength,s=this._options.corridorMaxLength;for(this._rooms=[],this._corridors=[],this._rooms.push(new f.default(1,1,e(i,o),e(i,o)));this._rooms.length<n;){var u=e(0,this._rooms.length-1),a=this._rooms[u],c=e(i,o),h=e(i,o),l=new f.default(0,0,c,h),_=e(r,s),p=new f.default(0,0,1,1),d=e(0,3),y=!1,g=l.width-a.width,v=l.height-a.height;0===d||2===d?(l.y=a.y-e(0,v),p.y=e(Math.max(a.top,l.top),Math.min(a.bottom,l.bottom)),p.width=_):(l.x=a.x-e(0,g),p.height=_,p.x=e(Math.max(a.left,l.left),Math.min(a.right,l.right))),0===d?(l.x=a.right+_+1,p.x=a.right+1):1===d?(l.y=a.bottom+_+1,p.y=a.bottom+1):2===d?(l.x=a.left-_-l.width,p.x=a.left-p.width):(l.y=a.top-_-l.height,p.y=a.top-p.height);for(var b=0;b<this._rooms.length;b++){if(l.collides(this._rooms[b])){y=!0;break}if(p.collides(this._rooms[b])&&u!==b){y=!0;break}}for(var m=0;m<this._corridors.length;m++)if(l.collides(this._corridors[m])){y=!0;break}y||(this._rooms.push(l),this._corridors.push(p))}}},{key:"_optimizeBuilds",value:function(){var t=this._getTopLeft();t.x<1&&this._translateBuilds(1-t.x,0),t.y<1&&this._translateBuilds(0,1-t.y)}},{key:"_getTopLeft",value:function(){var t=new u.default(1/0,1/0);return this.builds.forEach(function(e){e.x<t.x&&(t.x=e.x),e.y<t.y&&(t.y=e.y)}),t}},{key:"_getBottomRight",value:function(){var t=new u.default(-1/0,-1/0);return this.builds.forEach(function(e){e.right>t.x&&(t.x=e.right),e.bottom>t.y&&(t.y=e.bottom)}),t}},{key:"_translateBuilds",value:function(t,e){this.builds.forEach(function(n){n.x+=t,n.y+=e})}},{key:"_createMap",value:function(){var t=this,e=this._getBottomRight();this._fillMap(e.x+2,e.y+2),this.builds.forEach(function(e){t._fillRectangle(e.x,e.y,e.width,e.height)})}},{key:"_fillMap",value:function(t,e){this._tiles=[];for(var n=0;n<e;n++){this._tiles.push([]);for(var i=0;i<t;i++)this._tiles[n].push(!1)}}},{key:"_fillRectangle",value:function(t,e,n,i){for(var o=e;o<=e+i-1;o++)for(var r=t;r<=t+n-1;r++)this._tiles[o][r]=!0}},{key:"rooms",get:function(){return this._rooms}},{key:"corridors",get:function(){return this._corridors}},{key:"builds",get:function(){return this._rooms.concat(this._corridors)}},{key:"width",get:function(){return Array.isArray(this._tiles[0])?this._tiles[0].length:0}},{key:"height",get:function(){return this._tiles.length}},{key:"options",get:function(){return this._options}},{key:"prng",get:function(){return this._prng}}]),t}();e.default=l},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(0),s=function(t){return t&&t.__esModule?t:{default:t}}(r),u=function(){function t(e){i(this,t),e instanceof Function?this._isTransparent=e:(console.warn("Pathfinder: argument "+e+" is not a Function"),this._isTransparent=null)}return o(t,[{key:"_line",value:function(t,e){for(var n=e.x-t.x,i=e.y-t.y,o=Math.abs(n),r=Math.abs(i),u=n>0?1:-1,a=i>0?1:-1,f=new s.default(t.x,t.y),c=[new s.default(f.x,f.y)],h=0,l=0;h<o||l<r;)(.5+h)/o==(.5+l)/r?(f.x+=u,f.y+=a,h++,l++):(.5+h)/o<(.5+l)/r?(f.x+=u,h++):(f.y+=a,l++),c.push(new s.default(f.x,f.y));return c}},{key:"calculate",value:function(t,e,n,i){if(!(this._isTransparent instanceof Function))return console.warn("Explorer.calculate: "+this._isTransparent+" is not a Function");if(isNaN(t)||isNaN(e)||isNaN(n))return console.warn("Explorer.calculate: arguments "+n+" must be a Number");if(!(i instanceof Function))return console.warn("Explorer.calculate: argument "+i+" is not a Function");for(var o=Math.pow(n,2),r=new s.default(t,e),u=r.x-n,a=r.x+n,f=r.y-n,c=r.y+n,h=f;h<=c;h++)for(var l=u;l<=a;l++)if(h===f||h===c||l===u||l===a)for(var _=this._line(r,new s.default(l,h)),p=0;p<_.length;p++){var d=_[p],y=Math.pow(r.x-d.x,2)+Math.pow(r.y-d.y,2);if(!(y<=o))break;if(!this._isTransparent(d.x,d.y))break;i(d.x,d.y)}}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=n(6),s=function(t){return t&&t.__esModule?t:{default:t}}(r),u=function(){function t(e){i(this,t),e instanceof Function?this._isWalkable=e:(console.warn("Pathfinder.constructor: value "+e+" is not a Function"),this._isWalkable=null)}return o(t,[{key:"_heuristic",value:function(t,e,n,i){return Math.abs(n-t)+Math.abs(i-e)}},{key:"_findNode",value:function(t,e){if(e instanceof s.default)for(var n=0;n<t.length;n++)if(t[n].x===e.x&&t[n].y===e.y)return n}},{key:"_getNeighbors",value:function(t){for(var e=[],n=t.y-1;n<=t.y+1;n++)for(var i=t.x-1;i<=t.x+1;i++)(i===t.x&&n!=t.y||i!=t.x&&n===t.y)&&this._isWalkable(i,n)&&e.push(new s.default({x:i,y:n,g:t.g+1,parent:t}));return e}},{key:"search",value:function(t,e,n,i){if(!(this._isWalkable instanceof Function))return console.warn("Pathfinder.search: "+this._isWalkable+" is not a Function");for(var o=new s.default({x:t,y:e}),r=new s.default({x:n,y:i}),u=[o],a=[];u.length>0;){var f=0,c=u[0];if(u.forEach(function(t,e){t.f<c.f&&(c=t,f=e)}),u.splice(f,1),a.push(c),c.x===r.x&&c.y===r.y){for(var h=c,l=[];h.parent;)l.push(h),h=h.parent;return l.reverse()}for(var _=this._getNeighbors(c),p=0;p<_.length;p++){var d=_[p];this._findNode(a,d)||(this._findNode(u,d)||(d.h=this._heuristic(d.x,d.y,r.x,r.y),u.push(d)))}}return[]}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(u),f=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.x,t.y));return n._g=isNaN(t.g)?0:t.g,n._h=isNaN(t.h)?0:t.h,n._parent=t.parent instanceof e?t.parent:null,n}return r(e,t),s(e,[{key:"g",get:function(){return this._g},set:function(t){isNaN(t)||(this._g=t)}},{key:"h",get:function(){return this._h},set:function(t){isNaN(t)||(this._h=t)}},{key:"parent",get:function(){return this._parent},set:function(t){t instanceof e&&(this._parent=t)}},{key:"f",get:function(){return this.g+this.h}}]),e}(a.default);e.default=f},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(0),a=function(t){return t&&t.__esModule?t:{default:t}}(u),f=function(t){function e(t,n,r,s){i(this,e);var u=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return u._width=isNaN(r)?1:r,u._height=isNaN(s)?1:s,u}return r(e,t),s(e,[{key:"collides",value:function(t){return!(t.left>this.left+this.width||t.left+t.width<this.left||t.top>this.top+this.height||t.top+t.height<this.top)}},{key:"width",get:function(){return this._width},set:function(t){isNaN(t)||(this._width=t)}},{key:"height",get:function(){return this._height},set:function(t){isNaN(t)||(this._height=t)}},{key:"top",get:function(){return this._y}},{key:"right",get:function(){return this._x+this._width-1}},{key:"bottom",get:function(){return this._y+this._height-1}},{key:"left",get:function(){return this._x}}]),e}(a.default);e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(3),u=i(s),a=n(5),f=i(a),c=n(4),h=i(c),l=n(2),_=i(l),p=function(){function t(){o(this,t),this._Dungeon=u.default,this._Explorer=h.default,this._Pathfinder=f.default,this._PRNG=_.default}return r(t,[{key:"Dungeon",get:function(){return this._Dungeon}},{key:"Explorer",get:function(){return this._Explorer}},{key:"Pathfinder",get:function(){return this._Pathfinder}},{key:"PRNG",get:function(){return this._PRNG}}]),t}();t.exports=new p}])});