!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.rglk=e():t.rglk=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=7)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,n){r(this,t),this._x=isNaN(e)?0:e,this._y=isNaN(e)?0:n}return i(t,[{key:"distance",value:function(t){return Math.sqrt(Math.pow(t.x-this.x,2)+Math.pow(t.y-this.y,2))}},{key:"x",get:function(){return this._x},set:function(t){isNaN(t)?console.warn("Point.x: value "+t+" is NaN"):this._x=t}},{key:"y",get:function(){return this._y},set:function(t){isNaN(t)?console.warn("Point.y: value "+t+" is NaN"):this._y=t}}]),t}();e.default=o},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e){r(this,t),this._seed=isNaN(e)?12345:e}return i(t,[{key:"getRandom",value:function(t,e){return e=isNaN(e)?1:e,t=isNaN(t)?0:t,this._seed=(9301*this._seed+49297)%233280,t+this._seed/233280*(e-t)}},{key:"seed",get:function(){return this._seed},set:function(t){isNaN(t)||(this._seed=t)}}]),t}();e.default=o},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(0),a=r(u),s=n(6),f=r(s),l=n(1),c=r(l),h=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),n=n instanceof Object?n:{},this._tiles=[],this._rooms=[],this._corridors=[],this._prng=new c.default(isNaN(n.seed)?0:n.seed),this._options={},Object.keys(n).forEach(function(t){var r=n[t];e._options[t]=isNaN(r)||r<1?1:r})}return o(t,[{key:"getRooms",value:function(){return this._rooms}},{key:"getCorridors",value:function(){return this._corridors}},{key:"getBuilds",value:function(){return this._rooms.concat(this._corridors)}},{key:"getWidth",value:function(){return Array.isArray(this._tiles[0])?this._tiles[0].length:0}},{key:"getHeight",value:function(){return Array.isArray(this._tiles)?this._tiles.length:0}},{key:"getSeed",value:function(){return this._prng.seed}},{key:"forEachTile",value:function(t){if(this._tiles){if(t instanceof Function)for(var e=0;e<this._tiles.length;e++)for(var n=0;n<this._tiles[e].length;n++)t(n,e,this._tiles[e][n]);return this}}},{key:"isWall",value:function(t,e){if(void 0!==this._tiles[e]&&void 0!==this._tiles[e][t])return!this._tiles[e][t]}},{key:"generate",value:function(){return this._generateBuilds(),this._optimizeBuilds(),this._createMap(),this}},{key:"_generateBuilds",value:function(){var t=this,e=function(e,n){return Math.round(t._prng.getRandom(n,e))},n=this._options.roomAmount,r=this._options.roomMinSize,i=this._options.roomMaxSize,o=this._options.corridorMinLength,u=this._options.corridorMaxLength;for(this._rooms=[],this._corridors=[],this._rooms.push(new f.default(1,1,e(r,i),e(r,i)));this._rooms.length<n;){var a=e(0,this._rooms.length-1),s=this._rooms[a],l=e(r,i),c=e(r,i),h=new f.default(0,0,l,c),y=e(o,u),_=new f.default(0,0,1,1),p=e(0,3),d=!1,g=h.width-s.width,v=h.height-s.height;0===p||2===p?(h.y=s.y-e(0,v),_.y=e(Math.max(s.top,h.top),Math.min(s.bottom,h.bottom)),_.width=y):(h.x=s.x-e(0,g),_.height=y,_.x=e(Math.max(s.left,h.left),Math.min(s.right,h.right))),0===p?(h.x=s.right+y+1,_.x=s.right+1):1===p?(h.y=s.bottom+y+1,_.y=s.bottom+1):2===p?(h.x=s.left-y-h.width,_.x=s.left-_.width):(h.y=s.top-y-h.height,_.y=s.top-_.height);for(var b=0;b<this._rooms.length;b++){if(h.collides(this._rooms[b])){d=!0;break}if(_.collides(this._rooms[b])&&a!==b){d=!0;break}}for(var w=0;w<this._corridors.length;w++)if(h.collides(this._corridors[w])){d=!0;break}d||(this._rooms.push(h),this._corridors.push(_))}}},{key:"_optimizeBuilds",value:function(){var t=this._getTopLeft();t.x<1&&this._translateBuilds(1-t.x,0),t.y<1&&this._translateBuilds(0,1-t.y)}},{key:"_getTopLeft",value:function(){var t=new a.default(1/0,1/0);return this.getBuilds().forEach(function(e){e.x<t.x&&(t.x=e.x),e.y<t.y&&(t.y=e.y)}),t}},{key:"_getBottomRight",value:function(){var t=new a.default(-1/0,-1/0);return this.getBuilds().forEach(function(e){e.right>t.x&&(t.x=e.right),e.bottom>t.y&&(t.y=e.bottom)}),t}},{key:"_translateBuilds",value:function(t,e){this.getBuilds().forEach(function(n){n.x+=t,n.y+=e})}},{key:"_createMap",value:function(){var t=this,e=this._getBottomRight();this._fillMap(e.x+2,e.y+2),this.getBuilds().forEach(function(e){t._fillRectangle(e.x,e.y,e.width,e.height)})}},{key:"_fillMap",value:function(t,e){this._tiles=[];for(var n=0;n<e;n++){this._tiles.push([]);for(var r=0;r<t;r++)this._tiles[n].push(!1)}}},{key:"_fillRectangle",value:function(t,e,n,r){for(var i=e;i<=e+r-1;i++)for(var o=t;o<=t+n-1;o++)this._tiles[i][o]=!0}}]),t}();e.default=h},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),u=function(t){return t&&t.__esModule?t:{default:t}}(o),a=function(){function t(e){r(this,t),e instanceof Function?this._isTransparent=e:(console.warn("Pathfinder: argument "+e+" is not a Function"),this._isTransparent=null)}return i(t,[{key:"_line",value:function(t,e){for(var n=e.x-t.x,r=e.y-t.y,i=Math.abs(n),o=Math.abs(r),a=n>0?1:-1,s=r>0?1:-1,f=new u.default(t.x,t.y),l=[new u.default(f.x,f.y)],c=0,h=0;c<i||h<o;)(.5+c)/i==(.5+h)/o?(f.x+=a,f.y+=s,c++,h++):(.5+c)/i<(.5+h)/o?(f.x+=a,c++):(f.y+=s,h++),l.push(new u.default(f.x,f.y));return l}},{key:"calculate",value:function(t,e,n,r){if(!(this._isTransparent instanceof Function))return console.warn("Explorer.calculate: "+this._isTransparent+" is not a Function");if(isNaN(t)||isNaN(e)||isNaN(n))return console.warn("Explorer.calculate: arguments "+n+" must be a Number");if(!(r instanceof Function))return console.warn("Explorer.calculate: argument "+r+" is not a Function");for(var i=Math.pow(n,2),o=new u.default(t,e),a=o.x-n,s=o.x+n,f=o.y-n,l=o.y+n,c=f;c<=l;c++)for(var h=a;h<=s;h++)if(c===f||c===l||h===a||h===s)for(var y=this._line(o,new u.default(h,c)),_=0;_<y.length;_++){var p=y[_],d=Math.pow(o.x-p.x,2)+Math.pow(o.y-p.y,2);if(!(d<=i))break;if(!this._isTransparent(p.x,p.y))break;r(p.x,p.y)}}}]),t}();e.default=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(5),u=function(t){return t&&t.__esModule?t:{default:t}}(o),a=function(){function t(e){r(this,t),e instanceof Function?this._isWalkable=e:(console.warn("Pathfinder.constructor: value "+e+" is not a Function"),this._isWalkable=null)}return i(t,[{key:"_heuristic",value:function(t,e,n,r){return Math.abs(n-t)+Math.abs(r-e)}},{key:"_findNode",value:function(t,e){if(e instanceof u.default)for(var n=0;n<t.length;n++)if(t[n].x===e.x&&t[n].y===e.y)return n}},{key:"_getNeighbors",value:function(t){for(var e=[],n=t.y-1;n<=t.y+1;n++)for(var r=t.x-1;r<=t.x+1;r++)(r===t.x&&n!=t.y||r!=t.x&&n===t.y)&&this._isWalkable(r,n)&&e.push(new u.default({x:r,y:n,g:t.g+1,parent:t}));return e}},{key:"search",value:function(t,e,n,r){if(!(this._isWalkable instanceof Function))return console.warn("Pathfinder.search: "+this._isWalkable+" is not a Function");for(var i=new u.default({x:t,y:e}),o=new u.default({x:n,y:r}),a=[i],s=[];a.length>0;){var f=0,l=a[0];if(a.forEach(function(t,e){t.f<l.f&&(l=t,f=e)}),a.splice(f,1),s.push(l),l.x===o.x&&l.y===o.y){for(var c=l,h=[];c.parent;)h.push(c),c=c.parent;return h.reverse()}for(var y=this._getNeighbors(l),_=0;_<y.length;_++){var p=y[_];this._findNode(s,p)||(this._findNode(a,p)||(p.h=this._heuristic(p.x,p.y,o.x,o.y),a.push(p)))}}return[]}}]),t}();e.default=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),s=function(t){return t&&t.__esModule?t:{default:t}}(a),f=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.x,t.y));return n._g=isNaN(t.g)?0:t.g,n._h=isNaN(t.h)?0:t.h,n._parent=t.parent instanceof e?t.parent:null,n}return o(e,t),u(e,[{key:"g",get:function(){return this._g},set:function(t){isNaN(t)||(this._g=t)}},{key:"h",get:function(){return this._h},set:function(t){isNaN(t)||(this._h=t)}},{key:"parent",get:function(){return this._parent},set:function(t){t instanceof e&&(this._parent=t)}},{key:"f",get:function(){return this.g+this.h}}]),e}(s.default);e.default=f},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(0),s=function(t){return t&&t.__esModule?t:{default:t}}(a),f=function(t){function e(t,n,o,u){r(this,e);var a=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return a._width=isNaN(o)?1:o,a._height=isNaN(u)?1:u,a}return o(e,t),u(e,[{key:"collides",value:function(t){return!(t.left>this.left+this.width||t.left+t.width<this.left||t.top>this.top+this.height||t.top+t.height<this.top)}},{key:"width",get:function(){return this._width},set:function(t){isNaN(t)||(this._width=t)}},{key:"height",get:function(){return this._height},set:function(t){isNaN(t)||(this._height=t)}},{key:"top",get:function(){return this._y}},{key:"right",get:function(){return this._x+this._width-1}},{key:"bottom",get:function(){return this._y+this._height-1}},{key:"left",get:function(){return this._x}}]),e}(s.default);e.default=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(2),a=r(u),s=n(4),f=r(s),l=n(3),c=r(l),h=n(1),y=r(h),_=function(){function t(){i(this,t),this._Dungeon=a.default,this._Explorer=c.default,this._Pathfinder=f.default,this._PRNG=y.default}return o(t,[{key:"Dungeon",get:function(){return this._Dungeon}},{key:"Explorer",get:function(){return this._Explorer}},{key:"Pathfinder",get:function(){return this._Pathfinder}},{key:"PRNG",get:function(){return this._PRNG}}]),t}();t.exports=new _}])});