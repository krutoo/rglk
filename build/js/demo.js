!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n}return r(e,[{key:"distanceTo",value:function(e){return e=e||{},Math.sqrt(Math.pow(e.x-this.x,2)+Math.pow(e.y-this.y,2))}},{key:"isEqualTo",value:function(t){var n=!1;return t instanceof e&&(n=t.x===this.x&&t.y===this.y),n}},{key:"x",get:function(){return Number(this._x)||0},set:function(e){isNaN(e)||(this._x=Number(e))}},{key:"y",get:function(){return Number(this._y)||0},set:function(e){isNaN(e)||(this._y=Number(e))}}],[{key:"create",value:function(t){return new e((t=t||{}).x,t.y)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._seed=isNaN(t)||!isFinite(t)?Math.random():Number(t)}return r(e,[{key:"generate",value:function(e,t){return t=isNaN(t)?1:Number(t),(e=isNaN(e)?0:Number(e))+this._updateSeed()/233280*(t-e)}},{key:"_updateSeed",value:function(){return this._seed=(9301*this._seed+49297)%233280}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),u=(r=o)&&r.__esModule?r:{default:r};var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{};var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.x,e.y));return n.g=e.g,n.h=e.h,n.parent=e.parent,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default),i(t,[{key:"getPathToRoot",value:function(){for(var e=[],t=this;t.parent;)e.push(t),t=t.parent;return e.reverse()}},{key:"g",get:function(){return Number(this._g)||0},set:function(e){isNaN(e)||(this._g=Number(e))}},{key:"h",get:function(){return Number(this._h)||0},set:function(e){isNaN(e)||(this._h=Number(e))}},{key:"parent",get:function(){return this._parent instanceof t?this._parent:null},set:function(e){e instanceof t&&(this._parent=e)}},{key:"f",get:function(){return this.g+this.h}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),u=(r=o)&&r.__esModule?r:{default:r};var a=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(t instanceof Function))throw new TypeError("Pathfinder.constructor: first argument must be a function");this._isOpen=t}return i(e,[{key:"search",value:function(e,t,n,r){for(var i=this,o=new u.default({x:e,y:t}),a=new u.default({x:n,y:r}),s=[o],l=[],c=[],f=function(){var e=0,t=s[0];if(s.forEach(function(n,r){n.f<t.f&&(t=n,e=r)}),s.splice(e,1),l.push(t),t.isEqualTo(a))return c=t.getPathToRoot(),"break";for(var n=i._getNeighbors(t),r=function(e){var t=n[e];if(l.find(function(e){return e.isEqualTo(t)}))return"continue";s.find(function(e){return e.isEqualTo(t)})||(t.h=i._getHeuristic(t.x,t.y,a.x,a.y),s.push(t))},o=0;o<n.length;o++)r(o)};s.length;){if("break"===f())break}return c}},{key:"_getHeuristic",value:function(e,t,n,r){return Math.abs(n-e)+Math.abs(r-t)}},{key:"_getNeighbors",value:function(e){for(var t=[],n=-1;n<=1;n++)for(var r=-1;r<=1;r++)1===Math.abs(r+n)&&this._isOpen(e.x+r,e.y+n)&&t.push(new u.default({x:e.x+r,y:e.y+n,g:e.g+1,parent:e}));return t}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),u=(r=o)&&r.__esModule?r:{default:r};var a=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!(t instanceof Function))throw new TypeError("Explorer.calculate: "+this._isTransparent+" is not a Function");this._isTransparent=t}return i(e,[{key:"_getPointsOfLine",value:function(e,t){for(var n=t.x-e.x,r=t.y-e.y,i=Math.abs(n),o=Math.abs(r),a=n>0?1:-1,s=r>0?1:-1,l=new u.default(e.x,e.y),c=[new u.default(l.x,l.y)],f=0,h=0;f<i||h<o;)(.5+f)/i==(.5+h)/o?(l.x+=a,l.y+=s,f++,h++):(.5+f)/i<(.5+h)/o?(l.x+=a,f++):(l.y+=s,h++),c.push(new u.default(l.x,l.y));return c}},{key:"calculate",value:function(e,t,n,r){this.checkArguments.apply(this,arguments);for(var i=Math.pow(n,2),o=new u.default(e,t),a=o.x-n,s=o.x+n,l=o.y-n,c=o.y+n,f=l;f<=c;f++)for(var h=a;h<=s;h++)if(f===l||f===c||h===a||h===s)for(var d=this._getPointsOfLine(o,new u.default(h,f)),y=0;y<d.length;y++){var p=d[y];if(!(Math.pow(o.x-p.x,2)+Math.pow(o.y-p.y,2)<=i))break;if(!this._isTransparent(p.x,p.y))break;r(p.x,p.y)}}},{key:"checkArguments",value:function(e,t,n,r){if(isNaN(e)||isNaN(t)||isNaN(n))throw new TypeError("Explorer.calculate: first three arguments must be a number");if(!(r instanceof Function))throw new TypeError("Explorer.calculate: fourth argument must be a function")}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),u=(r=o)&&r.__esModule?r:{default:r};var a=function(e){function t(e,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.width=r,o.height=i,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default),i(t,[{key:"collides",value:function(e){var t=!1;return e.x<=this.x+this.width&&e.x+e.width>=this.x&&e.y<=this.y+this.height&&e.height+e.y>=this.y&&(t=!0),t}},{key:"forEachPoint",value:function(e){}},{key:"width",get:function(){return Number(this._width)||0},set:function(e){isNaN(e)||(this._width=Number(e))}},{key:"height",get:function(){return Number(this._height)||0},set:function(e){isNaN(e)||(this._height=Number(e))}},{key:"top",get:function(){return this.y}},{key:"right",get:function(){return this.x+this.width}},{key:"bottom",get:function(){return this.y+this.height}},{key:"left",get:function(){return this.x}},{key:"center",get:function(){return new u.default(this.x+this.width/2,this.y+this.height/2)}}],[{key:"create",value:function(e){return new t((e=e||{}).x,e.y,e.width,e.height)}}]),t}();t.default=a,window.Rectangle=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(1)),o=a(n(0)),u=a(n(5));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this._tiles=[],this._rooms=[],this._corridors=[],this._prng=new i.default(t.seed),this._options=this.validateOptions(t),this.generate()}return r(e,[{key:"validateOptions",value:function(e){var t=this;e=e||{};var n={};return Object.keys(this.defaultOptions).forEach(function(r){var i=e[r];isNaN(i)||!isFinite(i)||i<1?n[r]=parseInt(t.defaultOptions[r],10)||1:n[r]=parseInt(i,10)}),n}},{key:"forEachTile",value:function(e){if(this._tiles&&e instanceof Function)for(var t=0;t<this._tiles.length;t++)for(var n=0;n<this._tiles[t].length;n++)e(n,t,this._tiles[t][n]);return this}},{key:"isFloor",value:function(){var e;return!(e=this.isWall).call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"isWall",value:function(e,t){var n=!1;return Array.isArray(this._tiles[t])&&this._tiles[t].hasOwnProperty(e)&&(n=!this._tiles[t][e]),n}},{key:"generate",value:function(){this._generateBuilds(),this._optimizeBuilds(),this._createMap()}},{key:"_generateBuilds",value:function(){var e=this,t=function(t,n){return Math.floor(e._prng.generate(n,t))},n=this._options,r=n.roomsAmount,i=n.roomMinSize,o=n.roomMaxSize,a=n.corridorMinLength,s=n.corridorMaxLength;this._rooms=[],this._corridors=[],this._rooms.push(new u.default(1,1,t(i,o),t(i,o))),this._rooms[0].children=[];for(var l=function(){var n=e._rooms[t(0,e._rooms.length-1)],r=t(i,o),l=t(i,o),c=new u.default(0,0,r,l),f=t(a,s),h=new u.default(0,0,1,1),d=parseInt(4*Math.random(),10);n.children.push(h),c.parent=h,c.children=[],h.parent=n,h.children=[c],0===d||2===d?(c.y=n.bottom-1-t(0,Math.abs(c.height+n.height)-1),h.y=t(Math.max(n.top,c.top),Math.min(n.bottom,c.bottom)-1),h.width=f):(c.x=n.right-1-t(0,Math.abs(c.width+n.width)-1),h.height=f,h.x=t(Math.max(n.left,c.left),Math.min(n.right,c.right))),0===d?(c.x=n.right+f,h.x=n.right):1===d?(c.y=n.bottom+f,h.y=n.bottom):2===d?(c.x=n.left-f-c.width,h.x=n.left-h.width):(c.y=n.top-f-c.height,h.y=n.top-h.height),e._isSuitableBuilds(c,h)?(e._rooms.push(c),e._corridors.push(h)):(n.children=n.children.filter(function(e){return e!==h}),h.children=h.children.filter(function(e){return e!==c}))};this._rooms.length<r;)l()}},{key:"_isSuitableBuilds",value:function(){var e=this;return Array.from(arguments).every(function(t){return!e.builds.filter(function(e){return e.parent!==t.parent&&e!==t.parent&&e!==t.children&&!e.children.includes(t.parent)}).some(function(n){return e._isCollide(n,t)})})}},{key:"_isCollide",value:function(e,t){return e.collides(t)}},{key:"_optimizeBuilds",value:function(){var e=this._getTopLeft();e.x<1&&this._translateBuilds(1-e.x,0),e.y<1&&this._translateBuilds(0,1-e.y)}},{key:"_getTopLeft",value:function(){var e=new o.default(1/0,1/0);return this.builds.forEach(function(t){t.x<e.x&&(e.x=t.x),t.y<e.y&&(e.y=t.y)}),e}},{key:"_getBottomRight",value:function(){var e=new o.default(-1/0,-1/0);return this.builds.forEach(function(t){t.right>e.x&&(e.x=t.right),t.bottom>e.y&&(e.y=t.bottom)}),e}},{key:"_translateBuilds",value:function(e,t){this.builds.forEach(function(n){n.x+=e,n.y+=t})}},{key:"_createMap",value:function(){var e=this,t=this._getBottomRight();this._fillMap(t.x+2,t.y+2),this.builds.forEach(function(t){e._fillRectangle(t.x,t.y,t.width,t.height)})}},{key:"_fillMap",value:function(e,t){this._tiles=[];for(var n=0;n<t;n++){this._tiles.push([]);for(var r=0;r<e;r++)this._tiles[n].push(!1)}}},{key:"_fillRectangle",value:function(e,t,n,r){for(var i=t;i<=t+r-1;i++)for(var o=e;o<=e+n-1;o++)this._tiles[i][o]=!0}},{key:"defaultOptions",get:function(){return{seed:Math.random(),roomsAmount:7,roomMinSize:5,roomMaxSize:10,corridorMinLength:3,corridorMaxLength:7,corridorComplexity:3}}},{key:"rooms",get:function(){return this._rooms.slice()}},{key:"corridors",get:function(){return this._corridors.slice()}},{key:"builds",get:function(){return this.rooms.concat(this.corridors)}},{key:"width",get:function(){return Array.isArray(this._tiles[0])?this._tiles[0].length:0}},{key:"height",get:function(){return Array.isArray(this._tiles)?this._tiles.length:0}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(1)),i=a(n(6)),o=a(n(4)),u=a(n(3));function a(e){return e&&e.__esModule?e:{default:e}}t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.assign(this,{PRNG:r.default,Dungeon:i.default,Explorer:o.default,Pathfinder:u.default})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pathfinder=t.Explorer=t.Dungeon=t.PRNG=void 0;var r,i=n(7);var o=new((r=i)&&r.__esModule?r:{default:r}).default;t.default=o;t.PRNG=o.PRNG,t.Dungeon=o.Dungeon,t.Explorer=o.Explorer,t.Pathfinder=o.Pathfinder},function(e,t,n){"use strict";var r,i=n(8),o=(r=i)&&r.__esModule?r:{default:r};function u(e,t){var n=document.querySelector(e);if(n){var r=n.querySelector("canvas"),i=n.querySelector(".js-reload-button");r&&(r.width=r.clientWidth,r.height=r.width/4*3,t(r)),i&&i.addEventListener("click",function(){return t(r)})}}function a(e,t){t=t||{};var n=e.getContext("2d"),r=t,i=r.fov,o=r.path,u=r.dungeon;t.tileSize=function(e,t){var n=Math.min(t.width,t.height),r=Math.max(e.width,e.height);return Math.floor(n/r)||8}(u,e),n.clearRect(0,0,e.width,e.height),u&&(function(e,t){var n=t=t||{},r=n.dungeon,i=n.roomColor,o=void 0===i?"#445":i,u=n.corridorColor,a=void 0===u?"#223":u,s=n.tileSize;r.rooms.forEach(function(n,r){e.fillStyle=o,e.fillRect(n.x*s,n.y*s,n.width*s,n.height*s),t.needRoomsNumbers&&(e.fillStyle="rgba(255,255,255,.5)",e.textBaseline="middle",e.textAlign="center",e.font=s+"px Arial",e.fillText(r,n.center.x*s,n.center.y*s))}),r.corridors.forEach(function(t){e.fillStyle=a,e.fillRect(t.x*s,t.y*s,t.width*s,t.height*s)})}(n,t),i&&function(e,t){var n=t.fov,r=t.center,i=t.radius,o=(t.dungeon,t.tileSize);n.forEach(function(t){var n=r.distanceTo(t),u=1-n/i;e.fillStyle="rgba(255,210,150,"+u+")",e.globalAlpha=.1,e.fillRect(t.x*o,t.y*o,o,o),e.globalAlpha=1})}(n,t),o&&function(e,t){var n=t.path,r=(t.dungeon,t.tileSize);e.strokeStyle="#0e0",e.lineWidth=Math.ceil(r/3),n.length&&(e.beginPath(),e.moveTo(n[0].x*r+r/2,n[0].y*r+r/2),n.forEach(function(t){e.lineTo(t.x*r+r/2,t.y*r+r/2)}),e.stroke(),e.closePath())}(n,t))}u(".js-section-dungeon",function(e){a(e,{dungeon:new o.default.Dungeon({roomsAmount:24,roomMinSize:3,roomMaxSize:10,corridorMinLength:1,corridorMaxLength:10*Math.random(),seed:Math.random()}),roomColor:"#445",corridorColor:"#223",needRoomsNumbers:!0})}),u(".js-section-labyrinth",function(e){a(e,{dungeon:new o.default.Dungeon({roomsAmount:128,roomMinSize:1,roomMaxSize:1,corridorMinLength:1,corridorMaxLength:1,seed:Math.random()}),roomColor:"#445",corridorColor:"#445"})}),u(".js-section-explorer",function(e){var t=new o.default.Dungeon({roomsAmount:6,roomMinSize:3,roomMaxSize:12,corridorMinLength:1,corridorMaxLength:1,seed:Math.random()}),n=[];new o.default.Explorer(function(e,n){return!t.isWall(e,n)}).calculate(parseInt(t.rooms[0].center.x,10),parseInt(t.rooms[0].center.y,10),16,function(e,t){return n.push({x:e,y:t})}),a(e,{fov:n,dungeon:t,radius:16,center:t.rooms[0].center})}),u(".js-section-pathfinder",function(e){var t=new o.default.Dungeon({roomsAmount:24,roomMinSize:4,roomMaxSize:12,corridorMinLength:1,corridorMaxLength:5,seed:Math.random()});a(e,{path:new o.default.Pathfinder(function(e,n){return t.isFloor(e,n)}).search(parseInt(t.rooms[0].center.x,10),parseInt(t.rooms[0].center.y,10),parseInt(t.rooms[t.rooms.length-1].center.x,10),parseInt(t.rooms[t.rooms.length-1].center.y,10)),dungeon:t})})},function(e,t,n){n(9),e.exports=n(15)},,,,,function(e,t){}]);
//# sourceMappingURL=demo.js.map